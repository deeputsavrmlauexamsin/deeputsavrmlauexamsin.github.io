<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Print_Data</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body { margin:0; padding:0; background:#FAFAFA; font:12pt "Tahoma"; }
.page { width:18cm; min-height:22cm; padding:0cm; margin:0 auto; background:white; box-shadow:0 0 5px rgba(0,0,0,0.1);}
.responsive-image { width:100%; height:auto; }
table { width:100%; border-collapse:collapse; border:15px solid #f38610; outline:2px solid black; margin-bottom:20px;}
</style>
</head>
<body>

<div class="page">
<div class="container">
<table>
    <thead>
        <tr>
            <td colspan="5">
                <img src="NEWPRINTLOGO.png" class="responsive-image">
            </td>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td colspan="5" style="text-align:center"><b>परिचय पत्र</b></td>
        </tr>

        <tr>
            <td></td>
            <td><b>क्रo - </b><span id="user-id"></span></td>
        </tr>

        <tr>
            <td colspan="2">
                <img id="user-qr" src="" style="height:4cm;width:4cm;border:5px solid orange;">
            </td>
            <td colspan="3">
                <img id="user-photo" src="" style="height:5cm;width:4cm;border:5px solid orange;">
            </td>
        </tr>

        <tr>
            <td colspan="5" style="text-align:center;font-size:18px"><b id="user-college"></b></td>
        </tr>

        <tr>
            <td></td>
            <td><b>नाम :</b></td>
            <td colspan="3" id="user-name"></td>
        </tr>

        <tr>
            <td></td>
            <td><b>मोबाइल नंo :</b></td>
            <td colspan="3" id="user-phone"></td>
        </tr>

        <tr>
            <td></td>
            <td><b>तैनाती स्थल:</b></td>
            <td colspan="3" id="user-ghat"></td>
        </tr>

        <tr>
            <td></td>
            <td><b>दायित्व :</b></td>
            <td colspan="3" id="user-role"></td>
        </tr>
    </tbody>
</table>
</div>
</div>

<script>
// CONFIG
const BASE_URL = "https://deeputsavrmlauexamsin.github.io/Department/Print_Data/";
const CSV_URL = "https://raw.githubusercontent.com/deeputsavrmlauexamsin/deeputsavrmlauexamsin.github.io/main/Department/Print_Data/data.csv";

async function loadUser() {
    const params = new URLSearchParams(window.location.search);
    const slug = params.get('ID');
    if(!slug) return;

    const response = await fetch(CSV_URL);
    const csvText = await response.text();

    const lines = csvText.split('\n').filter(l => l.trim() !== '');
    const headers = lines[0].split('\t');
    let userData = null;

    for(let i=1;i<lines.length;i++){
        const values = lines[i].split('\t');
        let row = {};
        headers.forEach((h,j)=> row[h]=values[j]);
        if(row.slug === slug){
            userData = row;
            break;
        }
    }

    if(!userData) return;

    // Fill HTML
    document.getElementById('user-id').innerText = userData.id;
    document.getElementById('user-name').innerText = userData.name;
    document.getElementById('user-phone').innerText = userData.phone;
    document.getElementById('user-ghat').innerText = userData.ghat;
    document.getElementById('user-role').innerText = userData.role;
    document.getElementById('user-college').innerText = userData.college;

    document.getElementById('user-photo').src = "photos/" + userData.photo;
    document.getElementById('user-qr').src = "qr_codes/" + userData.id + "_QR.png";
}

window.onload = loadUser();
</script>

</body>
</html>
