<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Print_Data</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" rel="stylesheet">
<style type="text/css">
    body { margin:0; padding:0; background-color:#FAFAFA; font:12pt "Tahoma"; }
    * { box-sizing:border-box; -moz-box-sizing:border-box; }
    .page { width:18cm; min-height:22cm; padding:0cm; margin:0 auto; border-radius:5px; background:white; box-shadow:0 0 5px rgba(0,0,0,0.1); }
    .responsive-image { width:100%; height:auto; }
    table { width:100%; border-collapse:collapse; margin-bottom:20px; padding:0.5cm; border:15px solid #f38610; outline:2px solid black; }
    #dvaapat { text-align:center; margin-left:30%; margin-right:30%; background-color:#f38610; }
    @page { size:A4; margin:2cm; }
    @media print {
        .page { border-radius:initial; width:8cm; min-height:10cm; box-shadow:initial; background:initial; page-break-after:always; }
        body { font-size:10pt; margin:-10px; }
        table { display:table; margin:0.5cm 5cm 0.25cm 5cm; padding:0.5cm; border:15px solid #f38610; outline:2px solid black; }
    }
</style>
</head>
<body>

<div class="book">
<div class="page">
    <div class="container">
        <div class="row">
            <table class="table-responsive">
                <thead>
                    <tr>
                        <td colspan="5">
                            <div class="box-title">
                                <img src="https://deeputsavrmlauexamsin.github.io/Department/Print_Data/NEWPRINTLOGO.png" class="responsive-image">
                            </div>
                        </td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td colspan="5" style="text-align:center"><h5><b>परिचय पत्र</b></h5></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><h5 style="text-align:left"><b>क्रo - <span id="user-id"></span></b></h5></td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <img id="user-qr" class="responsive-image" style="height:4cm; width:4cm; border:5px solid orange;">
                        </td>
                        <td colspan="3">
                            <img id="user-photo" class="responsive-image" style="height:5cm; width:4cm; border:5px solid orange;">
                        </td>
                    </tr>
                    <tr style="height:0.5cm;"></tr>
                    <tr>
                        <td colspan="5" style="text-align:center;font-size:18px"><b id="user-college"></b></td>
                    </tr>
                    <tr style="height:0.5cm;"></tr>
                    <tr>
                        <td></td>
                        <td><b>नाम :</b></td>
                        <td colspan="3" id="user-name"></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><b>मोबाइल नंo :</b></td>
                        <td colspan="3" id="user-phone"></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><b>तैनाती स्थल:</b></td>
                        <td colspan="3" id="user-ghat"></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><b>दायित्व :</b></td>
                        <td colspan="3" id="user-role"></td>
                    </tr>
                    <tr style="height:1cm;"></tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td>
                            <img class="responsive-image" style="height:1.5cm; width:2.5cm;" src="https://deeputsavrmlauexamsin.github.io/Department/Print_Data/SIGNSS.png">
                        </td>
                        <td style="text-align:right">
                            <img class="responsive-image" style="height:1.5cm; width:3cm;" src="https://deeputsavrmlauexamsin.github.io/Department/Print_Data/SIGN.png">
                        </td>
                    </tr>
                    <tr style="border-bottom:2px dashed black;">
                        <td></td>
                        <td style="text-align:left"><b> प्राधिकृत हस्ताक्षरी <br>संस्था/इकाई</b></td>
                        <td></td>
                        <td><b> नोडल अधिकारी</b></td>
                        <td style="text-align:right"><b> प्राधिकृत हस्ताक्षरी <br> जिला प्रशासन</b></td>
                    </tr>
                    <tr style="height:0.7cm;"></tr>
                    <tr>
                        <td colspan="5" style="text-align:center">
                            <b>आपात संपर्क सूत्र:</b> +91 8808160420 &nbsp;&nbsp; +91 9170838005
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
</div>

<script>
const CSV_URL = "https://raw.githubusercontent.com/deeputsavrmlauexamsin/deeputsavrmlauexamsin.github.io/main/Department/Print_Data/data.csv";

async function loadUser() {
    const params = new URLSearchParams(window.location.search);
    const slug = params.get('ID');
    if(!slug) return;

    const response = await fetch(CSV_URL);
    const csvText = await response.text();

    const lines = csvText.split('\n').filter(l => l.trim() !== '');
    const headers = lines[0].split('\t');
    let userData = null;

    for(let i=1;i<lines.length;i++){
        const values = lines[i].split('\t');
        let row = {};
        headers.forEach((h,j)=> row[h]=values[j]);
        if(row.slug === slug){
            userData = row;
            break;
        }
    }

    if(!userData) return;

    document.getElementById('user-id').innerText = userData.id;
    document.getElementById('user-name').innerText = userData.name;
    document.getElementById('user-phone').innerText = userData.phone;
    document.getElementById('user-ghat').innerText = userData.ghat;
    document.getElementById('user-role').innerText = userData.role;
    document.getElementById('user-college').innerText = userData.college;

    document.getElementById('user-photo').src =
      "https://deeputsavrmlauexamsin.github.io/Department/Print_Data/photos/" + encodeURIComponent(userData.photo);

    document.getElementById('user-qr').src =
      "https://deeputsavrmlauexamsin.github.io/Department/Print_Data/qr_codes/" + encodeURIComponent(userData.id + "_QR.png");
}

window.onload = loadUser();
</script>

</body>
</html>
